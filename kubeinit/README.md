<p style="text-align: center" align="center">
    <a href="https://www.kubeinit.com"><img src="https://raw.githubusercontent.com/Kubeinit/kubeinit/master/images/logo.svg?sanitize=true" alt="The KUBErnetes INITiator"/></a>
</p>

**The KUBErnetes INITiator**


<p style="text-align: center" align="center">
    <a href="https://www.python.org"><img height="30px" src="https://raw.githubusercontent.com/pystol/pystol-docs/master/assets/badges/made-with-python.svg?sanitize=true"/> </a>
    <a href="https://www.ansible.com"><img height="30px" src="https://raw.githubusercontent.com/pystol/pystol-docs/master/assets/badges/made-with-ansible.svg?sanitize=true"/> </a>
    <a href="https://www.kubeinit.com"><img height="30px" src="https://raw.githubusercontent.com/pystol/pystol-docs/master/assets/badges/made-with-love.svg?sanitize=true"/> </a>
    <a href="https://www.kubeinit.com"><img height="30px" src="https://raw.githubusercontent.com/pystol/pystol-docs/master/assets/badges/cloud-native.svg?sanitize=true"/> </a>
</p>

<p style="text-align: center" align="center">
    <a href="https://github.com/Kubeinit/kubeinit/actions?workflow=linters"><img height="20px" src="https://github.com/Kubeinit/kubeinit/workflows/linters/badge.svg?event=push"/> </a>
    <a href="https://github.com/Kubeinit/kubeinit/actions?workflow=units"><img height="20px" src="https://github.com/Kubeinit/kubeinit/workflows/units/badge.svg?event=push"/> </a>
    <a href="https://github.com/Kubeinit/kubeinit/actions?workflow=molecule"><img height="20px" src="https://github.com/Kubeinit/kubeinit/workflows/molecule/badge.svg?event=push"/> </a>
    <a href="https://github.com/Kubeinit/kubeinit/actions?workflow=release"><img height="20px" src="https://github.com/Kubeinit/kubeinit/workflows/release/badge.svg?event=push"/> </a>
    <a href="https://github.com/Kubeinit/kubeinit/actions?workflow=container_image"><img height="20px" src="https://github.com/Kubeinit/kubeinit/workflows/container_image/badge.svg?event=push"/> </a>
    <a href="https://kubernetes.slack.com/archives/C01FKK19T0B"><img height="20px" src="https://img.shields.io/badge/chat-on%20slack-blue.svg?logo=slack&longCache=true&style=flat"/> </a>
</p>

## Periodic jobs

<p style="text-align: center" align="center">
    <a href="https://kubeinit-bot.github.io/kubeinit-ci-results/periodic-k8s-libvirt-3-1-periodic-weekly-go/index.html"><img height="20px" src="https://raw.githubusercontent.com/kubeinit-bot/kubeinit-ci-results/master/periodic-k8s-libvirt-3-1-periodic-weekly-go/badge_status.svg?sanitize=true"/></a>
    <a href="https://kubeinit-bot.github.io/kubeinit-ci-results/periodic-k8s-libvirt-1-1-periodic-weekly-go/index.html"><img height="20px" src="https://raw.githubusercontent.com/kubeinit-bot/kubeinit-ci-results/master/periodic-k8s-libvirt-1-1-periodic-weekly-go/badge_status.svg?sanitize=true"/></a>
    <a href="https://kubeinit-bot.github.io/kubeinit-ci-results/periodic-k8s-libvirt-1-0-periodic-weekly-go/index.html"><img height="20px" src="https://raw.githubusercontent.com/kubeinit-bot/kubeinit-ci-results/master/periodic-k8s-libvirt-1-0-periodic-weekly-go/badge_status.svg?sanitize=true"/></a>
    <a href="https://kubeinit-bot.github.io/kubeinit-ci-results/periodic-eks-libvirt-3-1-periodic-weekly-go/index.html"><img height="20px" src="https://raw.githubusercontent.com/kubeinit-bot/kubeinit-ci-results/master/periodic-eks-libvirt-3-1-periodic-weekly-go/badge_status.svg?sanitize=true"/></a>
    <a href="https://kubeinit-bot.github.io/kubeinit-ci-results/periodic-eks-libvirt-1-1-periodic-weekly-go/index.html"><img height="20px" src="https://raw.githubusercontent.com/kubeinit-bot/kubeinit-ci-results/master/periodic-eks-libvirt-1-1-periodic-weekly-go/badge_status.svg?sanitize=true"/></a>
    <a href="https://kubeinit-bot.github.io/kubeinit-ci-results/periodic-eks-libvirt-1-0-periodic-weekly-go/index.html"><img height="20px" src="https://raw.githubusercontent.com/kubeinit-bot/kubeinit-ci-results/master/periodic-eks-libvirt-1-0-periodic-weekly-go/badge_status.svg?sanitize=true"/></a>
    <a href="https://kubeinit-bot.github.io/kubeinit-ci-results/periodic-cdk-libvirt-3-1-periodic-weekly-go/index.html"><img height="20px" src="https://raw.githubusercontent.com/kubeinit-bot/kubeinit-ci-results/master/periodic-cdk-libvirt-3-1-periodic-weekly-go/badge_status.svg?sanitize=true"/></a>
    <a href="https://kubeinit-bot.github.io/kubeinit-ci-results/periodic-cdk-libvirt-1-1-periodic-weekly-go/index.html"><img height="20px" src="https://raw.githubusercontent.com/kubeinit-bot/kubeinit-ci-results/master/periodic-cdk-libvirt-1-1-periodic-weekly-go/badge_status.svg?sanitize=true"/></a>
    <a href="https://kubeinit-bot.github.io/kubeinit-ci-results/periodic-cdk-libvirt-1-0-periodic-weekly-go/index.html"><img height="20px" src="https://raw.githubusercontent.com/kubeinit-bot/kubeinit-ci-results/master/periodic-cdk-libvirt-1-0-periodic-weekly-go/badge_status.svg?sanitize=true"/></a>
    <a href="https://kubeinit-bot.github.io/kubeinit-ci-results/periodic-okd-libvirt-3-1-periodic-weekly-go/index.html"><img height="20px" src="https://raw.githubusercontent.com/kubeinit-bot/kubeinit-ci-results/master/periodic-okd-libvirt-3-1-periodic-weekly-go/badge_status.svg?sanitize=true"/></a>
    <a href="https://kubeinit-bot.github.io/kubeinit-ci-results/periodic-okd-libvirt-1-1-periodic-weekly-go/index.html"><img height="20px" src="https://raw.githubusercontent.com/kubeinit-bot/kubeinit-ci-results/master/periodic-okd-libvirt-1-1-periodic-weekly-go/badge_status.svg?sanitize=true"/></a>
    <a href="https://kubeinit-bot.github.io/kubeinit-ci-results/periodic-okd-libvirt-1-0-periodic-weekly-go/index.html"><img height="20px" src="https://raw.githubusercontent.com/kubeinit-bot/kubeinit-ci-results/master/periodic-okd-libvirt-1-0-periodic-weekly-go/badge_status.svg?sanitize=true"/></a>
    <a href="https://kubeinit-bot.github.io/kubeinit-ci-results/periodic-rke-libvirt-3-1-periodic-weekly-go/index.html"><img height="20px" src="https://raw.githubusercontent.com/kubeinit-bot/kubeinit-ci-results/master/periodic-rke-libvirt-3-1-periodic-weekly-go/badge_status.svg?sanitize=true"/></a>
    <a href="https://kubeinit-bot.github.io/kubeinit-ci-results/periodic-rke-libvirt-1-1-periodic-weekly-go/index.html"><img height="20px" src="https://raw.githubusercontent.com/kubeinit-bot/kubeinit-ci-results/master/periodic-rke-libvirt-1-1-periodic-weekly-go/badge_status.svg?sanitize=true"/></a>
    <a href="https://kubeinit-bot.github.io/kubeinit-ci-results/periodic-rke-libvirt-1-0-periodic-weekly-go/index.html"><img height="20px" src="https://raw.githubusercontent.com/kubeinit-bot/kubeinit-ci-results/master/periodic-rke-libvirt-1-0-periodic-weekly-go/badge_status.svg?sanitize=true"/></a>
</p>

# What is KubeInit?

KubeInit provides Ansible playbooks and roles for the deployment
and configuration of multiple Kubernetes distributions.
KubeInit's mission is to have a fully automated way to deploy in
a single command a curated list of prescribed architectures.

## Documentation

KubeInit's documentation is hosted in [this same repository](https://docs.kubeinit.com).

## KubeInit supported scenarios

**K8s distribution:** OKD (testing K8S, RKE, EKS, RKE)

**Driver:** Libvirt

**OS:** CentOS/Fedora, Debian/Ubuntu

## Requirements

* A fresh deployed server with enough RAM and disk space (120GB in RAM and 300GB in disk) and CentOS 8 (it should work also in Fedora/Debian/Ubuntu hosts).
* We assume that the hypervisor node is called nyctea (defined in the inventory).
* Have root passwordless access with certificates.
* Adjust the inventory file to suit your needs i.e. [the worker nodes](https://github.com/Kubeinit/kubeinit/blob/master/kubeinit/hosts/okd/inventory#L66)
 you will need in your cluster.

# How to run

There are two ways of launching Kubeinit, directly using the
ansible-playbook command, or by running it inside a container.

## Directly executing the deployment playbook

The following example command will deploy a multi-master OKD 4.5 cluster with 1 worker node
in a single command and in approximately 30 minutes.

```bash
git clone https://github.com/Kubeinit/kubeinit.git
cd kubeinit
# Install Ansible collection requirements
ansible-galaxy collection install --force -r kubeinit/requirements.yml
ansible-playbook \
    --user root \
    -v -i ./hosts/okd/inventory \
    --become \
    --become-user root \
    ./playbooks/okd.yml
```

After provisioning any of the scenarios, you should have your environment ready to go.
To connect to the nodes from the hypervisor use the IP addresses from the inventory files.

## Running the deployment command from a container

The whole process is explained in the [HowTo's](https://www.anstack.com/blog/2020/09/11/Deploying-KubeInit-from-a-container.html).
The following commands build a container image with the project inside of it, and then
launches the container executing the ansible-playbook command with all the
standard ansible-playbook parameters.

### Running from the GIT repository

```
git clone https://github.com/Kubeinit/kubeinit.git
cd kubeinit
podman build -t kubeinit/kubeinit .

podman run --rm -it \
    -v ~/.ssh/id_rsa:/root/.ssh/id_rsa:z \
    -v /etc/hosts:/etc/hosts \
    kubeinit/kubeinit \
        --user root \
        -v -i ./hosts/okd/inventory \
        --become \
        --become-user root \
        ./playbooks/okd.yml
```

### Running from a release

```
# Get latest release tag name
TAG=$(curl --silent "https://api.github.com/repos/kubeinit/kubeinit/releases/latest" | jq -r .tag_name)
podman run --rm -it \
    -v ~/.ssh/id_rsa:/root/.ssh/id_rsa:z \
    -v /etc/hosts:/etc/hosts \
    quay.io/kubeinit/kubeinit:$TAG \
        --user root \
        -v -i ./hosts/okd/inventory \
        --become \
        --become-user root \
        ./playbooks/okd.yml
```

# HowTo's and presentations

* [The easiest and fastest way to deploy an OKD 4.5 cluster in a Libvirt/KVM Host](https://www.anstack.com/blog/2020/07/31/the-fastest-and-simplest-way-to-deploy-okd-openshift-4-5.html).
* [KubeInit external access for OpenShift/OKD deployments with Libvirt](https://www.anstack.com/blog/2020/08/25/KubeInit-External-access-for-OpenShift-OKD-deployments-with-Libvirt.html).
* [Deploying KubeInit from a container](https://www.anstack.com/blog/2020/09/11/Deploying-KubeInit-from-a-container.html).
* [KubeInit: Bringing good practices from the OpenStack ecosystem to improve the way OKD/OpenShift deploys](https://www.twitch.tv/videos/750577055), [slides](https://speakerdeck.com/redhatopenshift/openshift-deploys).
* [Persistent Volumes And Claims In KubeInit](https://www.anstack.com/blog/2020/09/28/Persistent-volumes-and-claims-in-KubeInit.html)
* [Deploying Multiple KubeInit Clusters In The Same Hypervisor](https://www.anstack.com/blog/2020/10/04/Multiple-KubeInit-clusters-in-the-same-hypervisor.html)
* [KubeInit 4-In-1 - Deploying Multiple Kubernetes Distributions (K8S, OKD, RKE, And CDK) With The Same Platform](https://www.anstack.com/blog/2020/10/19/KubeInit-4-in-1-Deploying-multiple-Kubernetes-distributions-K8S-OKD-RKE-and-CDK-with-the-same-platform.html)
